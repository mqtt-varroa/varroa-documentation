\chapter{Concepts}
To understand the workings of Varroa, we will have to take a look at the different parts that make up the system.
Furthermore we explain the basic concepts of MQTT.

\section{Varroa Distributed System Concepts}
A Varroa Distributed System orchestration of multiple Varroa instances consisting of one Commander and at least one Agent.
Varroa is organized as a distributed system, due to the impossibility of creating enough MQTT-clients on a single machine to overload a MQTT-broker, especially if the broker is also a distributed system.

\paragraph{Varroa Instance}
A Varroa instance is a running Varroa process in a single JVM, can be either Commander or Agent.

\paragraph{Commander}
The Commander is a part of the Varroa Distributed System, that parses the scenario, generates chunks and distributes them to the Agents.
Only one Commander exists in a Varroa distributed system.

\paragraph{Agent}
The Agent is part of the Varroa Distributed System.
It receives Chunks from the Commander and passes them to its MQTT-Agents.
A Varroa distributed system contains at least one Agent.

\paragraph{MQTT Agent}
MQTT Agents are components of an Agent.
Every MQTT Agent manages one MQTT client.

\paragraph{Chunk}
The scenario is split in Chunks by the Commander and then those Chunk are distributed to the agents.
%A Chunk is a Collection of Information, such as which commands are to be sent to the broker as well as how many clients should perform these commands.
%Another important information, contained in the Chunk is at which rate these commands are to be executed.

%A scenario is a XML-Document which defines a sequence of stages.

\section{Varroa Scenario Concepts}
The integral idea of Varroa is testing scenarios, which means simulating the behaviour of a large amount of MQTT clients.
It tests whether the broker can handle the associated load.
A scenario is an abstract representation of a real MQTT-Use-Case.
It defines the topology of all participating MQTT clients and brokers.

\paragraph{MQTT Client}
A MQTT client is used to execute the Commands to create load.
Those clients implement the MQTT protocol using the HiveMQ MQTT Client.

\paragraph{Client Group}
Client groups are part of the scenario.
They enable the user to define the behaviour and properties of a group of MQTT clients with a configurable size.
These MQTT clients are created by Varroa for the purpose of simulating the MQTT clients of a scenario.
The lifespan of the spawned MQTT clients does not exceed the lifespan of a scenario.

\paragraph{Command}
A command is an abstract representation of a work step that must be executed by a MQTT client.

\paragraph{Topic Group}
A Topic Group represents a number of topics that share a naming pattern.
This concept enables the user to model the interaction between Client Groups and a number of similar topics.

\section{General MQTT Concepts}
\paragraph{Broker}
The Broker serves as an intermediary between publishers and subscribers.
It takes over the routing of the exchanged MQTT messages and is the central control authority of a MQTT Network.
%TODO cite Georg
\paragraph{Client}
A client that implements the MQTT protocol. 
\paragraph{Topic}
Topics are strings separated by slashes that do not contain wild-cards.
Messages published with Topic are delivered to subscribers that have registered matching Topic Filters.
\paragraph{Topic Filter}
A Topic Filter is a chain of strings delimited by slashes that 
can cover one or more topics. 
It can also contain wild-cards: a plus sign covers a single hierarchy level, a double cross selects all possible following levels.
\paragraph{Publisher}
Publishers are clients that produce data.
They send messages with a specific topic to the broker.
\paragraph{Subscriber}
Subscribers are clients that subscribe to a subset or to all messages sent via the
MQTT network.
They log on to the broker and register with one or more topic filters that specify the topics whose messages they want to receive.
%TODO cite Georg
\paragraph{Connect}
Disconnect describes the process of a Client establishing a connection to a Broker.
\paragraph{Disconnect}
Connect describes the process of a Client terminating its connection to a Broker.


